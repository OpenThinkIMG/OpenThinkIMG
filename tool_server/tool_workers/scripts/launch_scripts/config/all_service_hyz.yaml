base_dir: /mnt/petrelfs/haoyunzhuo/mmtool/Tool-Factory/tool_server/tool_workers
log_folder: /mnt/petrelfs/haoyunzhuo/mmtool/Tool-Factory/tool_server/tool_workers/logs/server_log
partition: "MoE"
default_calculate_gpus: 0
default_calculate_cpus: 2
default_control_cpus: 2
default_control_gpus: 0
retry_interval: 1
request_timeout: 10

controller_config:
  worker_name: controller
  job_name: zc_controller
  calculate_type: control
  srun_kwargs:
    w: SH-IDCA1404-10-140-54-119
  cmd:
    script-addr: ./online_workers/controller.py
    port: 20001
    host: "0.0.0.0"

model_worker_config:
  - qwenvl:
      worker_name: qwenvl
      job_name: zc_qwenvl
      calculate_type: calculate
      srun_kwargs:
        w: SH-IDCA1404-10-140-54-119
      cuda_visible_devices: "4,5,6,7"
      cmd:
        script-addr: ../model_workers/qwen2vl_worker.py
        model-path: "/mnt/petrelfs/share_data/quxiaoye/models/Qwen2-VL-72B-Instruct" # /mnt/petrelfs/share_data/mmtool/weights/qwen-cogcom-filter
        model-name: Qwen2-VL-72B-Instruct
        port: 40001
        host: "0.0.0.0"

tool_worker_config:
  # - grouding:
  #     worker_name: grouding
  #     job_name: zc_grouding
  #     calculate_type: calculate
  #     cuda_visible_devices: "0"
  #     cmd:
  #       script-addr: ./online_workers/cogcom_grounding_worker.py
  #       port: 20017
  #       host: "0.0.0.0"
  #       model_base: "/mnt/petrelfs/share_data/quxiaoye/models/vicuna-7b-v1.5"
  #       model_path: "/mnt/petrelfs/share_data/quxiaoye/models/cogcom-grounding-17b"
  - point:
      worker_name: point
      job_name: zc_point
      calculate_type: calculate
      conda_env: "molmo-sam"
      srun_kwargs:
        w: SH-IDCA1404-10-140-54-119
      cuda_visible_devices: "1"
      cmd:
        script-addr: ./online_workers/molmo_point_worker.py
        port: 20027
        host: "0.0.0.0"
        model_path: "/mnt/petrelfs/share_data/mmtool/Molmo-7B-D-0924"
  - SAM2:
      worker_name: SAM2
      job_name: tool-SAM2
      calculate_type: calculate
      conda_env: "molmo-sam"
      srun_kwargs:
        w: SH-IDCA1404-10-140-54-119
      cuda_visible_devices: "2"
      cmd:
        script-addr: ./online_workers/SAMAroundPoint_worker.py
        port: 20036
        host: "0.0.0.0"
        sam2_checkpoint: /mnt/petrelfs/share_data/mmtool/sam2/sam2_hiera_large.pt
        sam2_model_cfg: sam2_hiera_l.yaml
  - DrawHorizontalLineByY:
      worker_name: DrawHorizontalLineByY
      job_name: tool-DrawHorizontalLine
      calculate_type: control
      srun_kwargs:
        w: SH-IDCA1404-10-140-54-119
      cmd:
        script-addr: ./online_workers/DrawHorizontalLineByY_worker.py
        port: 20037
        host: "0.0.0.0"
  - DrawVerticalLineByX:
      worker_name: DrawVerticalLineByX
      job_name: tool-DrawVerticalLine
      calculate_type: control
      srun_kwargs:
        w: SH-IDCA1404-10-140-54-119
      cmd:
        script-addr: ./online_workers/DrawVerticalLineByX_worker.py
        port: 20038
        host: "0.0.0.0"
  - SelectSubplot:
      worker_name: SelectSubplot
      job_name: tool-SelectSubplot
      calculate_type: control
      srun_kwargs:
        w: SH-IDCA1404-10-140-54-119
      cmd:
        script-addr: ./online_workers/SelectSubplot_worker.py
        port: 20039
        host: "0.0.0.0"
  # - ocr:
  #     worker_name: ocr
  #     job_name: zc_ocr
  #     calculate_type: control
  #     srun_kwargs:
  #       w: SH-IDCA1404-10-140-54-119
  #     cmd:
  #       script-addr: ./ocr_worker.py
  #       port: 20009
  #       host: "0.0.0.0"
  # - line:
  #     worker_name: line
  #     job_name: zc_line
  #     calculate_type: control
  #     cmd:
  #       script-addr: ./online_workers/drawline_worker.py
  #       port: 20011
  #       host: "0.0.0.0"
  # - crop:
  #     worker_name: crop
  #     job_name: zc_crop
  #     calculate_type: control
  #     cmd:
  #       script-addr: "./online_workers/crop_worker.py"
  #       port: 20013
  #       host: "0.0.0.0"
  